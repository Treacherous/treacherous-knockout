<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Treacherous Knockout Example</title>
    <link href="default-theme.css" type="text/css" rel="stylesheet"/>
    <style type="text/css">
        label
        {
            display: inline-block;
            width: 10em;
        }

        input
        {
            padding: 0.25em;
        }

        section>div
        {
            margin: 0.25em;
        }
    </style>
</head>
<body>
    <h2>Validate with nested objects and iterated elements</h2>
    <section data-bind="validate-with: validationGroup, template: 'validation-content-template'">
    </section>

    <h2>Force validation errors to display on load</h2>
    <section data-bind="validate-with: validationGroup, template: 'validation-content-template'" view-options="immediateErrors: true">
    </section>

    <h2>Show a validation summary</h2>
    <section data-bind="validate-with: validationGroup">
        <div data-bind="validation-summary"></div>
    </section>

    <h2>Hint validation properties</h2>
    <section data-bind="validate-with: validationGroup" view-options="immediateErrors: true">
        <label>Some Explicit Validation Error For someNestedObject.someNumber</label>
        <div data-bind="show-error" validate-property="someNestedObject.someNumber"></div>
    </section>

    <script id="validation-content-template" type="text/html">
        <div>
            <label>Some Number</label>
            <input data-bind="value: someNumber"/>
        </div>
        <div>
            <label>Some Text</label>
            <input data-bind="value: someText"/>
        </div>
        <div>
            <label>Some Nested Number</label>
            <input data-bind="value: someNestedObject.someNumber"/>
        </div>
        <!-- ko foreach: someArray -->
        <div>
            <label data-bind="text: 'Some Array - Index '+ ($index() + 1)"></label>
            <input data-bind="textInput: $rawData"/>
        </div>
        <!-- /ko -->
        <button data-bind="enabled-with: validationGroup">Enabled based upon validation state</button>
    </script>

    <script type="text/javascript" src="libs/bluebird.js"></script>
    <script type="text/javascript" src="libs/knockout.js"></script>
    <script type="text/javascript" src="../dist/treacherous-knockout.browser.js"></script>

    <script type="text/javascript">
        var someKoModel = {
            someNumber: ko.observable(10),
            someText: ko.observable("hello"),
            someNestedObject: {
              someNumber: ko.observable(200)
            },
            someArray: ko.observableArray([
                ko.observable(10), ko.observable(15), ko.observable(30)
            ])
        };

        var nestedRuleset = Treacherous.createRuleset()
                .forProperty("someNumber")
                    .addRule("maxValue", 100)
                .build();

        var ruleset = Treacherous.createRuleset()
                .forProperty("someNumber")
                    .addRule("maxValue", 20)
                    .withDisplayName("Some Custom Property Name")
                .forProperty("someText")
                    .addRule("required")
                    .addRule("minLength", 3)
                .forProperty("someNestedObject")
                    .addRuleset(nestedRuleset)
                .forProperty("someArray")
                    .addRule("maxLength", 2)
                    .addRuleForEach("maxValue", 20)
                .build();

        var validationGroup = Treacherous.createGroup().build(someKoModel, ruleset);

        ko.applyBindings(someKoModel);
    </script>
</body>
</html>